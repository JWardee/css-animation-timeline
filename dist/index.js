'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(exports,'__esModule',{value:!0});function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var CssAnimationTimeline=function(){function a(){return _classCallCheck(this,a),this._isPlaying=!1,this._keyframes=[],this._animationEndingEvents=['webkitTransitionEnd','otransitionend','oTransitionEnd','msTransitionEnd','transitionend'],this}return _createClass(a,[{key:'delay',value:function b(a){/** Allow method chaining */return this._keyframes.push({type:'delay',time:a}),this}},{key:'add',value:function e(a,b){var c=this,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;/** Allow method chaining */return document.querySelectorAll(a)// eslint-disable-line no-undef
.forEach(function(a){c._keyframes.push({type:'animate',el:a,classToAdd:b,staggerEach:d})}),this}},{key:'tidyUp',value:function b(){var a=this;/** Allow method chaining */return this._keyframes.forEach(function(b,c){a._unwatchElement(b.el,c)}),this}},{key:'play',value:function a(){return this._play(this._keyframes)}},{key:'replay',value:function a(){return this._play()}},{key:'reset',value:function a(){return this.tidyUp()}/** Private */},{key:'_play',value:function b(a){return this.tidyUp(),this._playKeyframes(a)}/** Private */},{key:'_playKeyframes',value:function d(a){var b=this;this._isPlaying=!0;var c=a.map(function(a,c){return function(){return b._playKeyframe(c)}});return c.reduce(function(a,b){return a.then(b)},Promise.resolve()).then(function(){b._isPlaying=!1})}/** Private */},{key:'_playKeyframe',value:function d(a){var b=this,c=this._getKeyframe(a);// console.log('Playing keyframe ' + keyframeIndex);
return new Promise(function(d,e){if(!1===b._isPlaying)return void e();switch(c.type){case'delay':setTimeout(d,c.time);break;default:b._unwatchElement(c.el,a),b._watchElement(c.el,a,d);}})}/** Private */},{key:'_getKeyframe',value:function b(a){return this._keyframes[a]}/** Private */},{key:'_unwatchElement',value:function d(a,b){var c=this._getKeyframe(b);'animate'!==c.type||(a.classList.remove(c.classToAdd),0!==c.staggerEach&&this._animationEndingEvents.forEach(function(b){return a.removeEventListener(b,c.finishCallback)}))}/** Private */},{key:'_watchElement',value:function e(a,b,c){var d=this._getKeyframe(b);d.finishCallback=c,a.classList.add(d.classToAdd),0===d.staggerEach?this._animationEndingEvents.forEach(function(b){return a.addEventListener(b,c)}):setTimeout(c,d.staggerEach)}}]),a}();exports.default=CssAnimationTimeline,module.exports=exports.default;